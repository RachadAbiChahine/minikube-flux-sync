---
apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: grafana
  namespace: monitoring
  annotations:
    fluxcd.io/automated: "false"
    fluxcd.io/tag.chart-image: semver:~4.0
spec:
  releaseName: grafana
  chart:
    repository: https://kubernetes-charts.storage.googleapis.com
    name: grafana
    version: 5.0.23
    paths: stable/
  values:
    grafana.ini:
      paths:
        data: /var/lib/grafana/data
        logs: /var/log/grafana
        plugins: /var/lib/grafana/plugins
        provisioning: /etc/grafana/provisioning
      analytics:
        check_for_updates: true
      log:
        mode: console
      grafana_net:
        url: https://grafana.net
      database:
        type: postgres
        host: quick-postgres.postgres-databases
        name: grafana
        user: grafana
        password: grafana
    rbac:
      create: false

    serviceAccount:
      create: false
    securityContext:
      runAsUser: 472
      runAsGroup: 472
      fsGroup: 472



    downloadDashboardsImage:
      repository: curlimages/curl
      tag: 7.68.0
      pullPolicy: IfNotPresent

    downloadDashboards:
      env: {}
      resources: {}

    ## Pod Annotations
    # podAnnotations: {}

    ## Pod Labels
    # podLabels: {}

    ingress:
      enabled: true
      path: /
      hosts:
        - grafana.minikube.local
      ## Extra paths to prepend to every host configuration. This is useful when working with annotation based services.

    persistence:
      type: pvc
      enabled: false
      # storageClassName: default
      accessModes:
        - ReadWriteOnce
      size: 5Gi
      # annotations: {}
      finalizers:
        - kubernetes.io/pvc-protection

    # Administrator credentials when not using an existing secret (see below)
    adminUser: admin
    adminPassword: admin


    plugins: []
    # - digrich-bubblechart-panel
    # - grafana-clock-panel

    ## Configure grafana datasources
    ## ref: http://docs.grafana.org/administration/provisioning/#datasources
    ##
